<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Book Tour — Qushal Tours</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />

  <style>
    body { font-family: 'Poppins', sans-serif; background:#f8fafc; margin:0; }
    .container { max-width:920px; margin:28px auto; padding:20px; }
    .card { background:#fff; border-radius:12px; box-shadow:0 6px 20px rgba(2,6,23,0.06); }
    label { font-weight:600; font-size:0.9rem; }
    @media print { .no-print{display:none!important} }
  </style>
</head>
<body>
  <div class="container">
    <header class="flex items-center justify-between mb-6">
      <a href="index.html" class="flex items-center gap-3 no-underline text-slate-800">
        <div style="width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,#06b6d4,#2563eb);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700">QT</div>
        <div>
          <div class="font-extrabold text-lg">Qushal Tours</div>
          <div class="text-sm text-slate-500">Booking</div>
        </div>
      </a>
      <a id="back-to-explore" class="text-sm text-slate-600 hover:text-cyan-600" href="indian_tours.html">Back to Tours</a>
    </header>

    <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <section class="lg:col-span-2 card p-6">
        <h1 id="page-title" class="text-2xl font-extrabold mb-1">Book Tour</h1>
        <p id="tour-subtitle" class="text-sm text-slate-600 mb-4">Fill details below to confirm your booking request.</p>

        <div class="mb-6 p-4 rounded-lg bg-slate-50 border border-slate-100">
          <div class="flex items-center justify-between">
            <div>
              <div id="tour-name" class="font-bold text-lg">—</div>
              <div id="tour-price" class="text-sm text-slate-600">Price: —</div>
            </div>
            <div id="tour-badge" class="text-sm text-slate-700">Tour booking</div>
          </div>
        </div>

        <form id="bookingForm" class="space-y-4" novalidate>
          <input type="hidden" id="tour-slug" name="tour-slug" value="">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label for="full-name">Full name</label>
              <input id="full-name" name="full-name" required class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="Your full name">
            </div>

            <div>
              <label for="phone">Phone</label>
              <input id="phone" name="phone" required type="tel" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="+91 98xxxx...">
            </div>

            <div>
              <label for="email">Email</label>
              <input id="email" name="email" type="email" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="you@example.com">
            </div>

            <div>
              <label for="passengers">Passengers</label>
              <input id="passengers" name="passengers" type="number" min="1" value="2" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
            </div>

            <div>
              <label for="pickup-location">Pickup city</label>
              <input id="pickup-location" name="pickup-location" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="e.g., Delhi">
            </div>

            <div>
              <label for="pickup-date">Preferred start date</label>
              <input id="pickup-date" name="pickup-date" type="date" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" required>
            </div>

            <div>
              <label for="return-date">Return date (optional)</label>
              <input id="return-date" name="return-date" type="date" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
            </div>

            <div>
              <label for="pickup-time">Preferred pickup time</label>
              <input id="pickup-time" name="pickup-time" type="time" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
            </div>

            <div>
              <label for="hotel-preference">Hotel preference</label>
              <select id="hotel-preference" name="hotel-preference" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
                <option value="">No preference</option>
                <option value="budget">Budget</option>
                <option value="standard">Standard</option>
                <option value="deluxe">Deluxe</option>
              </select>
            </div>

             <div>
+              <label for="vehicle-preference">Vehicle preference</label>
+              <select id="vehicle-preference" name="vehicle-preference" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
+                <option value="">No preference</option>
+                <option value="sedan">Sedan (4 seater)</option>
+                <option value="suv">SUV (6-7 seater)</option>
+                <option value="tempo-traveller">Tempo Traveller (12-15 seater)</option>
+                <option value="minibus">Mini Bus (20-30 seater)</option>
+                <option value="luxury">Luxury (Mercedes / Audi)</option>
+              </select>
+            </div>

            <div>
              <label for="payment-method">Payment method</label>
              <select id="payment-method" name="payment-method" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200">
                <option value="pay-later">Pay at booking office</option>
                <option value="upi">UPI</option>
                <option value="card">Card</option>
                <option value="netbanking">Netbanking</option>
              </select>
            </div>

            <div>
              <label for="promo-code">Promo code (optional)</label>
              <input id="promo-code" name="promo-code" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="Enter promo code">
            </div>

            <div>
              <label for="gst-number">GST / Company VAT (optional)</label>
              <input id="gst-number" name="gst-number" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="GSTIN for invoice">
            </div>

            <div>
              <label for="alt-phone">Alternate phone</label>
              <input id="alt-phone" name="alt-phone" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="Optional">
            </div>
          </div>

          <div>
            <label for="pickup-address">Full pickup address</label>
            <textarea id="pickup-address" name="pickup-address" rows="2" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="Apartment, landmark..."></textarea>
          </div>

          <div>
            <label for="instructions">Special instructions</label>
            <textarea id="instructions" name="instructions" rows="2" class="mt-1 w-full px-3 py-2 rounded-lg border border-gray-200" placeholder="Any requests or notes"></textarea>
          </div>

          <div class="flex items-center gap-3 mt-4 no-print">
            <button id="submitBtn" type="submit" class="bg-cyan-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-cyan-700">Book & Generate Ticket</button>
            <a id="cancel" class="text-sm text-slate-600 hover:text-slate-800" href="explore_tours.html">Cancel</a>
          </div>
        </form>
      </section>

      <aside class="card p-4">
        <h3 class="font-semibold mb-3">Need help?</h3>
        <p class="text-sm text-slate-600">Call us: <a href="tel:+919876543210" class="text-cyan-600 font-medium">+91 98765 43210</a></p>
        <p class="text-sm text-slate-600 mt-4">Or review tour details on the <a id="view-explore" class="text-cyan-600" href="explore_tours.html">tour page</a>.</p>
      </aside>
    </main>
  </div>

  <script>
    (function(){
      function safeCreateIcons(){ if(window.lucide && typeof lucide.createIcons==='function'){ try{ lucide.createIcons(); }catch(e){} } }

      const tours = {
        jaipur:{ title:"Jaipur — The Pink City (4D/3N)", price:"₹8,499" },
        goa:{ title:"Goa Beaches & Nightlife (3D/2N)", price:"₹6,999" },
        manali:{ title:"Manali — Himalayan Retreat (5D/4N)", price:"₹12,499" },
        kashmir:{ title:"Kashmir — Paradise on Earth (4D/3N)", price:"₹13,999" },
        rajasthan:{ title:"Rajasthan — Land of Kings (5D/4N)", price:"₹9,499" },
        kerala:{ title:"Kerala — Backwater Retreat (4D/3N)", price:"₹7,499" }
      };

      function q(selector){ return document.querySelector(selector); }
      const params = new URLSearchParams(window.location.search);
      const raw = (params.get('tour') || params.get('t') || '').trim();
      const slug = decodeURIComponent(raw).toLowerCase();

      document.addEventListener('DOMContentLoaded', () => {
        safeCreateIcons();

        const tourData = tours[slug] || null;
        if (tourData) {
          q('#tour-name').textContent = tourData.title;
          q('#tour-price').textContent = 'Price: ' + (tourData.price || '—');
          q('#tour-slug').value = slug;
          const exploreLink = q('#view-explore'); if (exploreLink) exploreLink.href = 'explore_tours.html?tour=' + encodeURIComponent(slug);
          const back = q('#back-to-explore'); if (back) back.href = 'explore_tours.html?tour=' + encodeURIComponent(slug);
        } else {
          q('#tour-name').textContent = 'Selected tour';
          q('#tour-price').textContent = 'Price: —';
        }

        // Form submission -> redirect to ticket generator with query params
        const form = q('#bookingForm');
        if (!form) return;

        function getVal(id){ const el=document.getElementById(id); return el ? el.value.trim() : ''; }

        form.addEventListener('submit', function(e){
          e.preventDefault();

          // minimal validation
          const required = ['full-name','phone','passengers','pickup-date'];
          for (const id of required){
            if (!getVal(id)){
              const el = document.getElementById(id);
              if(el) el.focus();
              alert('Please fill: ' + id.replace(/-/g,' '));
              return;
            }
          }

          // Build params expected by ticketgen
          const ps = new URLSearchParams();
          const tourSlug = getVal('tour-slug');
          if (tourSlug) {
            ps.set('tour-name', tourSlug);
            ps.set('drop-location', tours[tourSlug] ? tours[tourSlug].title : tourSlug);
          }

          // core contact & booking fields
          ps.set('full-name', getVal('full-name'));
          ps.set('phone', getVal('phone'));
          if (getVal('email')) ps.set('email', getVal('email'));
          if (getVal('alt-phone')) ps.set('alt-phone', getVal('alt-phone'));

          // trip details
          if (getVal('pickup-location')) ps.set('pickup-location', getVal('pickup-location'));
          if (getVal('pickup-date')) ps.set('pickup-date', getVal('pickup-date'));
          if (getVal('return-date')) ps.set('return-date', getVal('return-date'));
          if (getVal('pickup-time')) ps.set('pickup-time', getVal('pickup-time'));
          if (getVal('passengers')) ps.set('passengers', getVal('passengers'));

          // preferences & payment
          if (getVal('hotel-preference')) ps.set('hotel-preference', getVal('hotel-preference'));
           if (getVal('vehicle-preference')) ps.set('vehicle-preference', getVal('vehicle-preference'));
          if (getVal('payment-method')) ps.set('payment-method', getVal('payment-method'));
          if (getVal('promo-code')) ps.set('promo-code', getVal('promo-code'));
          if (getVal('gst-number')) ps.set('gst-number', getVal('gst-number'));


          // address & notes
          if (getVal('pickup-address')) ps.set('pickup-address', getVal('pickup-address'));
          if (getVal('instructions')) ps.set('instructions', getVal('instructions'));

          // Redirect to ticket generator page (same tab). To open new tab use window.open(...)
          const target = 'ticketgen1.html';
          window.location.href = target + '?' + ps.toString();
        });
      });
    })();
  </script>
</body>
</html>